<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palavra do Senhor</title>
    <style>
        *{
            padding: 0;
            margin: 0;
        }

        body{
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100vw;
            height: 100vh;
            background-color: lightcoral;
        }

        article{
            display: flex;
            flex-direction: column;
            width: 80vw;
        }

        article p{
            font-size: 2em;
        }

        article h2{
            align-self: flex-end;
        }


    </style>
</head>
<body>
    <main>
        <article id="container">

        </article>
		
		<script>

			const bibleApi = 'https://api.scripture.api.bible'

			let credentials = 'bfd88eb83c898b79dfdbabe7bd4eafc4';
			let brasilianBible = {id:'90799bb5b996fddc-01', language:'por'}

            async function makeRequest(url){

                let results = {}

                let config = {
                    method:"get", 
                    headers:{"api-key": credentials}
                }

                await fetch(url,config)
                .then((e)=>{return e.json()})
                .then((e)=>{results = e.data})

                let result = results[randomNumberGenerator(results.length)]

                return result
            }
        
            function MakeVerse(content,reference){
                return `${content}<h2>${reference}</h2>`
            }
            
            function ShowVerse(content,reference){
                let container = document.getElementById('container')
                container.insertAdjacentHTML('afterbegin', MakeVerse(content,reference))
            }
            
            function randomNumberGenerator(max){
                let number = Math.floor((max) * Math.random());
                return number
            }

            async function getRandomVerse(){
                
                let bookRequest = `${bibleApi}/v1/bibles/${brasilianBible.id}/books`
                let book = await makeRequest(bookRequest)
                
                let chaptersRequest = `${bibleApi}/v1/bibles/${brasilianBible.id}/books/${book.id}/chapters`
                let chapter = await makeRequest(chaptersRequest)

                let versesRequest = `${bibleApi}/v1/bibles/${brasilianBible.id}/chapters/${chapter.id}/verses`
                let verse = await makeRequest(versesRequest)

                let specificVerseRequest = `${bibleApi}/v1/bibles/${brasilianBible.id}/verses/${verse.id}`
                
                let specificVerse = {}
                await fetch(specificVerseRequest,
                {method:"get", headers:{"api-key": credentials}})
                .then((e)=>{return e.json()})
                .then((e)=>{specificVerse = e.data})
                
                ShowVerse(specificVerse.content ,verse.reference)
            }

            getRandomVerse()
			
		</script>
    </main>
</body>
</html>